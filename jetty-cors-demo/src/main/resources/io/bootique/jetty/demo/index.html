<html>
   <body>
      <h2 style="font-size: 36px; display: flex; justify-content: center; margin-top: 50px;">Test CORS</h2>

      <div style="display: flex; justify-content: center; margin-top: 50px;">
         <button name="ordinary" onClick="gotoOrdinary()" style="margin-right: 20px; font-size: 24px;">Ordinary page</button>

         <button name="page_with_cors" onClick="gotoPageWithCors()" style="margin-right: 20px; font-size: 24px;">Page with CORS</button>
      </div>

      <script language = "javascript" type = "text/javascript">

         function callDomain(theUrl) {
             const invocation = new XMLHttpRequest();
             invocation.open('POST', theUrl, true);
             invocation.setRequestHeader('Access-Control-Request-Method', 'POST');

             invocation.withCredentials = true;
             invocation.send();

             invocation.onload = function() {
                 if (invocation.status != 200) {
                   alert(`Error ${invocation.status}: ${invocation.statusText}`);
                 } else {
                   if (invocation.getResponseHeader('Access-Control-Allow-Origin') != null) {
                     alert(`CORS was added to header of response.`);
                   } else {
                     window.location.href=theUrl;
                   }
                 }
              };
         }

         function gotoOrdinary() {
            var ordinaryUrl = '/myapp/ordinary/ordinary_page.html';
            callDomain(ordinaryUrl);
         }

         function gotoPageWithCors() {
            var pageWithCorsUrl = '/myapp/with_cors/with_cors_page.html';
            callDomain(pageWithCorsUrl);
         }

      </script>
   </body>
</html>
